#!/bin/sh

MAX_ITERATIONS=30
SLEEP_TIME=0.5

if command -v streamdeck; then
  if ! pgrep -x "streamdeck" > /dev/null; then
    nohup streamdeck &
  fi

  i=0
  while [ $i -lt $MAX_ITERATIONS ]; do
    if pgrep -x "streamdeck" > /dev/null; then
      win_id=$(xdotool search --class "Streamdeck UI" | head -n 1)
      while [ -z "$win_id" ]; do
        sleep $SLEEP_TIME
        win_id=$(xdotool search --class "Streamdeck UI" | head -n 1)
      done
      xdotool windowminimize $win_id
      break
    else
      sleep $SLEEP_TIME
    fi
    i=$((i+1))
  done
else
  notify-send "streamdeck is NOT installed"
fi

exit 0

# vim: set ft=sh:
